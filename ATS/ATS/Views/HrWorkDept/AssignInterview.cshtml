@using ATS.DatabaseDB;
@using Microsoft.AspNetCore.Mvc
@using Microsoft.AspNetCore.Mvc.Rendering
@using Microsoft.AspNetCore.Mvc.ViewFeatures
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@model List<AssesmentResult>

<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>1.1</title>
    <link href="Css/bootstrap.min.css" rel="stylesheet">
    <script src="Js/bootstrap.bundle.min.js"></script>
    <script src="Js/bootstrap-table.min.js"></script>
    <link rel='stylesheet' href='Css/bootstrap-table.min.css'>
    <script src="Js/jquery.min.js"></script>
  
    <script type="text/javascript" src="Js/jquery.dataTables.min.js"></script>
  
    <script src="~/js/bootstrap-table.min.js"></script>
    <script src="~/js/jquery.dataTables.min.js"></script>
    <link href="Css/mainStyle.css" rel="stylesheet">
    <script src="~/js/jquery.dataTables.min.js"></script>
    <link href="~/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="~/css/bootstrap.min.css" rel="stylesheet">
    <script src="~/js/bootstrap.bundle.min.js"></script>
    <link href="~/css/mainStyle.css" rel="stylesheet">
    <script src="~/js/jquery.min.js"></script>

    <script src="~/js/jquery.min.js"></script>
    <script src="~/js/jquery.dataTables.min.js"></script>
    <script src="~/js/site.js"></script>
</head>
<body>
    <div class="container-fluid box">
        <div class="row col-md-12 header" id="header">
            <div class="col-sm-2 logospace">
                <img class="" src="Images/Logo.png" />
            </div>
            <div class="col-sm-10 headerBtns">
                <span class="profilePic pullright">
                    <img src="Images/Avatar.png" />
                </span>
                <div class="btn-group pullright loggedInBtn">
                    <button class="btn btn-secondary btn-sm dropdown-toggle loggedIn" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        John Doe
                    </button>
                    <ul class="dropdown-menu logout">
                        <a href="#">Logout</a>
                    </ul>
                </div>

                <span class="notificationIcon pullright">
                    <img src="Images/icon_notification.png" />
                </span>
            </div>
        </div>
        <div class="row flex-nowrap content">
            <div class="col-auto col-md-3 col-xl-2 px-0 bg-dark">
                <div class="d-flex flex-column align-items-center align-items-sm-start text-white">

                    <ul class="nav nav-pills flex-column mb-sm-auto mb-0 align-items-center align-items-sm-start" id="menu">
                        <li class="nav-item">
                            <a href="#" class="nav-link align-middle active ">
                                <img src="Images/icon_home.png" /><span class="ms-1 d-none d-sm-inline">Home</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link align-middle">
                                <img src="Images/icon_dashboard.png" /><span class="ms-1 d-none d-sm-inline">Menu 1</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link  align-middle">
                                <img src="Images/icon_inbox.png" /><span class="ms-1 d-none d-sm-inline">Menu 2</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link  align-middle">
                                <img src="Images/icon_products.png" /><span class="ms-1 d-none d-sm-inline">Menu 3</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link align-middle">
                                <img src="Images/icon_Invoices.png" /><span class="ms-1 d-none d-sm-inline">Menu 4</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link align-middle">
                                <img src="Images/icon_customers.png" /><span class="ms-1 d-none d-sm-inline">Menu 5</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link align-middle">
                                <img src="Images/icon_chat-room.png" /><span class="ms-1 d-none d-sm-inline">Menu 6</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link align-middle">
                                <img src="Images/icon_calendar.png" /><span class="ms-1 d-none d-sm-inline">Menu 7</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link align-middle">
                                <img src="Images/icon_help-center.png" /><span class="ms-1 d-none d-sm-inline">Menu 8</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link align-middle">
                                <img src="Images/icon_setting.png" /><span class="ms-1 d-none d-sm-inline">Menu 9</span>
                            </a>
                        </li>
                    </ul>
                    <hr>

                </div>
            </div>
            <div class="col-sm-10 tableContent">
                <div class="col-xs-12 col-sm-11 content2">
                    <div class="sectionHeading">
                        <h4>HR Work Department</h4>
                    </div>
                    <div class="col-sm-12 form">
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>MasterID</th>
                                        <th>First Name</th>
                                        <th>Cognitive Test</th>
                                        <th>Behaviour Test</th>
                                        <th>Typing Test	</th>
                                        <th>Verbal Test</th>
                                        <th>Average Score</th>
                                        <th>Interview1</th>
                                        <th>Interview2</th>
                                        <th>Interview3 </th>
                                        <th>Select </th>
                                        <th>Reject </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var candidate in Model)
                                    {
                                        <tr>
                                            <td>@candidate.MasterId</td>
                                            <td>@candidate.CandidateName</td>
                                            <td>@candidate.CognitiveTest</td>
                                            <td>@candidate.BehaviourTest</td>
                                            <td>@candidate.TypingTest</td>
                                            <td>@candidate.VerbalTest</td>
                                            <td>@candidate.AverageScore</td>
                                            <td>@candidate.Interview1</td>
                                            <td>@candidate.Interview2</td>
                                            <td>@candidate.Interview3</td>
                                            <td style="text-align: center;">
                                                <img src="~/Images/Cooreect.jfif" class="img-fluid" alt="Previous Image" style="max-width: 30px; max-height: 30px;" onclick="AssignInterView(event)" />


                                            </td>
                                            <td>
                                                <img src="~/Images/Wrong.png" class="img-fluid" alt="Previous Image" style="max-width: 30px; max-height: 30px;" onclick="HnadleRejectionMassage('@candidate.MasterId')" />

                                            </td>
                                        </tr>
                                    }

                                </tbody>
                            </table>

                        </div>
                    </div>
                </div>
            </div>



        </div>
    </div>


    <script>
        function AssignInterView(event) {
            var button = event.target;
            var row = button.closest('tr');
            var masterId = row.querySelector('td:nth-child(1)').innerText;

            var interview1 = row.querySelector('td:nth-child(8)').innerText;
            var interview2 = row.querySelector('td:nth-child(9)').innerText;
            var interview3 = row.querySelector('td:nth-child(10)').innerText;

            var dataToSend = {
                MasterId: masterId,
                Interview1: interview1,
                Interview2: interview2,
                Interview3: interview3
            };

            $.ajax({
                url: '/HrWorkDept/AssignInterviewDyanamicStage',
                type: 'POST',
                data: dataToSend,
                success: function (result) {

                    if (result === "Condition not true") {
                        var url = '@Url.Action("DynamicInterviewStage", "HrWorkDept")';
                        window.location.href = url;
                    } else {
                        // Handle success if needed
                    }

                    if (result === "Condition not False") {
                        var url = '@Url.Action("Onbourding", "HrWorkDept")';
                        window.location.href = url;
                    } else {
                        // Handle success if needed
                    }
                },
                error: function (error) {
                    // Handle error if needed
                    console.error(error);
                }
            });

        }

        function HnadleRejectionMassage(masterId) {
            // Prompt the user for rejection message
            var rejectionMessage = "Thank you for applying. Unfortunately, your application was rejected";



            $.ajax({
                url: '/HrWorkDept/RejectionMassge',
                type: 'POST',
                data: { masterId: masterId, rejectionMessage: rejectionMessage },
                success: function (result) {

                    if (result.success) {
                        alert("Employee rejected successfully.");
                        location.reload();

                    } else {
                        alert("Error: " + result.message);
                    }



                },
                error: function (error) {
                    // Handle error if needed
                    console.error(error);
                }
            });
        }

    </script>
</body>

</html>
